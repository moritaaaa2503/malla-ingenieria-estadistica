<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Malla Ingenier√≠a Estad√≠stica</title>

  <style>
    :root{
      --bg1:#dff6ff;
      --bg2:#eaf9ff;

      --text:#1f4d63;
      --title:#245d76;

      --ramo:#f7feff;
      --ramoHover:#ffffff;

      --aprobBg:#bfefff;
      --aprobText:#2f2f2f;

      --stroke: rgba(31, 77, 99, 0.25);
      --shadow: rgba(0,0,0,0.14);
      --shadowSoft: rgba(0,0,0,0.10);
    }

    body{
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      background: linear-gradient(to right, var(--bg1), var(--bg2));
      margin: 0;
      padding: 18px 18px 26px 18px;
      color: var(--text);
    }

    h1{
      text-align:center;
      margin: 10px 0 10px 0;
      font-size: clamp(22px, 2.7vw, 34px);
      color: var(--title);
      letter-spacing: 0.2px;
    }

    .topbar{
      display:flex;
      justify-content:center;
      gap: 10px;
      margin-bottom: 10px;
      flex-wrap: wrap;
    }

    .btn{
      border: 2px solid rgba(23,63,82,0.20);
      background: rgba(255,255,255,0.65);
      color:#173f52;
      padding: 8px 12px;
      border-radius: 999px;
      cursor:pointer;
      font-weight: 700;
      font-size: 13px;
      box-shadow: 0 3px 10px rgba(0,0,0,0.08);
      transition: 0.15s ease;
    }
    .btn:hover{
      background: rgba(255,255,255,0.90);
      transform: translateY(-1px);
    }

    .nota{
      text-align:center;
      margin: 0 0 10px 0;
      color: rgba(23,63,82,0.75);
      font-size: 13px;
    }

    /* Panel de progreso / hitos */
    .status{
      max-width: 980px;
      margin: 0 auto 14px auto;
      background: rgba(255,255,255,0.70);
      border: 2px solid rgba(23,63,82,0.16);
      border-radius: 16px;
      box-shadow: 0 6px 16px rgba(0,0,0,0.10);
      padding: 12px 14px;
    }

    .statusRow{
      display:flex;
      flex-wrap: wrap;
      gap: 10px;
      align-items:center;
      justify-content: space-between;
    }

    .badge{
      display:inline-flex;
      align-items:center;
      gap: 8px;
      padding: 8px 12px;
      border-radius: 999px;
      font-weight: 800;
      font-size: 13px;
      border: 2px solid rgba(23,63,82,0.14);
      background: rgba(214,243,255,0.8);
      color: #173f52;
      white-space: nowrap;
    }

    .badge.ok{
      background: rgba(191,239,255,0.95);
      border-color: rgba(23,63,82,0.22);
    }

    .badge.lock{
      opacity: 0.55;
      filter: grayscale(20%);
    }

    .mini{
      font-size: 12px;
      color: rgba(23,63,82,0.78);
      margin-top: 8px;
      line-height: 1.25;
    }

    .bar{
      width: 100%;
      height: 10px;
      border-radius: 999px;
      background: rgba(23,63,82,0.12);
      overflow: hidden;
      margin-top: 10px;
    }

    .bar > div{
      height: 100%;
      width: 0%;
      background: rgba(36,93,118,0.55);
      border-radius: 999px;
      transition: width 0.2s ease;
    }

    .kpi{
      font-weight: 800;
      color:#173f52;
    }

    /* Contenedor horizontal */
    .container{
      display:flex;
      gap: 18px;
      overflow-x: auto;
      overflow-y: hidden;
      padding: 6px 6px 14px 6px;
      scroll-behavior: smooth;
    }

    .container::-webkit-scrollbar{ height: 10px; }
    .container::-webkit-scrollbar-track{ background: rgba(255,255,255,0.55); border-radius: 999px; }
    .container::-webkit-scrollbar-thumb{ background: rgba(36,93,118,0.25); border-radius: 999px; }

    .nivel{
      flex: 0 0 320px;
      border-radius: 18px;
      padding: 14px 14px 12px 14px;
      box-shadow: 0 8px 18px var(--shadow);
      border: 2px solid rgba(255,255,255,0.65);
      position: relative;
    }

    .nivel:nth-child(1){  background:#d6f3ff; }
    .nivel:nth-child(2){  background:#c6eeff; }
    .nivel:nth-child(3){  background:#b6e8ff; }
    .nivel:nth-child(4){  background:#a6e2ff; }
    .nivel:nth-child(5){  background:#96dcff; }
    .nivel:nth-child(6){  background:#86d6ff; }
    .nivel:nth-child(7){  background:#d2f7ff; }
    .nivel:nth-child(8){  background:#c2f1ff; }
    .nivel:nth-child(9){  background:#b1ebff; }
    .nivel:nth-child(10){ background:#a1e5ff; }

    .nivel h2{
      text-align:center;
      margin: 6px 0 10px 0;
      font-size: 18px;
      color: #173f52;
      padding-bottom: 8px;
      border-bottom: 2px solid rgba(23,63,82,0.18);
    }

    .ramo{
      background: var(--ramo);
      border: 2px solid rgba(31,77,99,0.18);
      box-shadow: 0 3px 10px var(--shadowSoft);
      border-radius: 14px;
      padding: 12px 12px;
      margin: 10px 0;
      cursor: pointer;
      user-select: none;
      transition: transform 0.12s ease, background 0.15s ease, border-color 0.15s ease;
      font-size: 16px;
      line-height: 1.25;
      text-align: center;
      font-weight: 600;
      color: #1b465b;
    }

    .ramo:hover{
      background: var(--ramoHover);
      border-color: rgba(31,77,99,0.28);
      transform: translateY(-1px);
    }

    .aprobado{
      background: var(--aprobBg) !important;
      color: var(--aprobText) !important;
      text-decoration: line-through;
      border-color: rgba(31,77,99,0.30) !important;
    }

    .creditos{
      text-align:center;
      margin-top: 10px;
      padding-top: 10px;
      border-top: 2px solid rgba(23,63,82,0.16);
      font-weight: 700;
      color: #173f52;
      font-size: 14px;
    }
  </style>

  <script>
    const STORAGE_KEY = "malla_aprobados_v1";

    // Hitos oficiales del plan (SCT-Chile):
    // Bachiller: 120 SCT, Licenciatura: 240 SCT, T√≠tulo: 300 SCT. (Res. 542 Plan 4702)
    const HITO_BACHILLER = 120;
    const HITO_LICENCIATURA = 240;
    const HITO_TITULO = 300;

    function getSaved() {
      try { return JSON.parse(localStorage.getItem(STORAGE_KEY)) || {}; }
      catch (e) { return {}; }
    }

    function saveAll(state) {
      localStorage.setItem(STORAGE_KEY, JSON.stringify(state));
    }

    function parseCreditos(textoRamo){
      // Extrae el n√∫mero final entre par√©ntesis: "√Ålgebra I (8)" -> 8
      const m = textoRamo.match(/\((\d+)\)\s*$/);
      return m ? Number(m[1]) : 0;
    }

    function calcTotales(){
      const ramos = Array.from(document.querySelectorAll(".ramo[data-id]"));
      let total = 0;
      let aprob = 0;

      ramos.forEach(el=>{
        const c = parseCreditos(el.textContent);
        total += c;
        if(el.classList.contains("aprobado")) aprob += c;
      });

      return { total, aprob };
    }

    function setBadge(id, ok){
      const el = document.getElementById(id);
      if(!el) return;
      el.classList.toggle("ok", ok);
      el.classList.toggle("lock", !ok);
      el.querySelector(".state").textContent = ok ? "Obtenible ‚úÖ" : "Pendiente ‚è≥";
    }

    function updateStatus(){
      const { total, aprob } = calcTotales();
      const pct = total > 0 ? Math.min(100, (aprob/total)*100) : 0;

      const txtCred = document.getElementById("credTxt");
      const barFill = document.getElementById("barFill");
      const titulo = document.getElementById("hitoActual");

      txtCred.innerHTML = `<span class="kpi">${aprob}</span> / ${total} cr√©ditos aprobados`;
      barFill.style.width = pct.toFixed(1) + "%";

      const okB = aprob >= HITO_BACHILLER;
      const okL = aprob >= HITO_LICENCIATURA;
      const okT = aprob >= HITO_TITULO;

      setBadge("badgeBach", okB);
      setBadge("badgeLic", okL);
      setBadge("badgeTit", okT);

      let msg = "A√∫n no alcanzas un hito de grado.";
      if(okT) msg = "Completaste los cr√©ditos del plan para el T√≠tulo (falta cumplir requisitos institucionales de titulaci√≥n).";
      else if(okL) msg = "Completaste los cr√©ditos para la Licenciatura.";
      else if(okB) msg = "Completaste los cr√©ditos para el Bachiller.";

      titulo.textContent = msg;
    }

    function toggleRamo(el){
      el.classList.toggle("aprobado");
      const id = el.getAttribute("data-id");
      const state = getSaved();
      state[id] = el.classList.contains("aprobado");
      saveAll(state);
      updateStatus();
    }

    function applySaved(){
      const state = getSaved();
      document.querySelectorAll(".ramo[data-id]").forEach(el=>{
        const id = el.getAttribute("data-id");
        if(state[id]) el.classList.add("aprobado");
      });
      updateStatus();
    }

    function resetAll(){
      if(!confirm("¬øSeguro que quieres desmarcar TODOS los ramos?")) return;
      localStorage.removeItem(STORAGE_KEY);
      document.querySelectorAll(".ramo").forEach(el=>el.classList.remove("aprobado"));
      updateStatus();
    }

    window.addEventListener("DOMContentLoaded", applySaved);
  </script>
</head>

<body>
  <h1>Malla Interactiva üíô</h1>

  <div class="topbar">
    <button class="btn" onclick="resetAll()">Reiniciar marcas</button>
  </div>
  <div class="nota">Haz clic en un ramo para marcarlo como aprobado. Se guarda autom√°ticamente ‚ú®</div>

  <!-- Panel de hitos -->
  <div class="status">
    <div class="statusRow">
      <div class="badge" id="badgeBach" title="Bachiller: 120 SCT">
        üéì Bachiller (120) ¬∑ <span class="state">Pendiente ‚è≥</span>
      </div>
      <div class="badge" id="badgeLic" title="Licenciatura: 240 SCT">
        üìò Licenciatura (240) ¬∑ <span class="state">Pendiente ‚è≥</span>
      </div>
      <div class="badge" id="badgeTit" title="T√≠tulo profesional: 300 SCT + requisitos institucionales">
        üèÅ T√≠tulo (300) ¬∑ <span class="state">Pendiente ‚è≥</span>
      </div>
    </div>

    <div class="mini">
      <div id="credTxt"><span class="kpi">0</span> / 300 cr√©ditos aprobados</div>
      <div class="bar" aria-label="Progreso de cr√©ditos"><div id="barFill"></div></div>
      <div class="mini" style="margin-top:8px;">
        <span class="kpi">Hito actual:</span> <span id="hitoActual">A√∫n no alcanzas un hito de grado.</span>
      </div>
      <div class="mini">
        Nota: que sea ‚Äúobtenible‚Äù por cr√©ditos no reemplaza el tr√°mite formal, y el t√≠tulo exige adem√°s requisitos institucionales de titulaci√≥n. (Res. 542 Plan 4702)
      </div>
    </div>
  </div>

  <div class="container">

    <!-- Nivel 1 -->
    <div class="nivel">
      <h2>Nivel 1</h2>
      <div class="ramo" data-id="n1-alg1" onclick="toggleRamo(this)">√Ålgebra I (8)</div>
      <div class="ramo" data-id="n1-cal1" onclick="toggleRamo(this)">C√°lculo I (8)</div>
      <div class="ramo" data-id="n1-intprob1" onclick="toggleRamo(this)">Intro. a la Prob. y Estad. I (8)</div>
      <div class="ramo" data-id="n1-tallerhab" onclick="toggleRamo(this)">Taller de Desarrollo de Habilidades (3)</div>
      <div class="ramo" data-id="n1-copro1" onclick="toggleRamo(this)">Coprogram√°tico I (3)</div>
      <div class="creditos">30 cr√©ditos</div>
    </div>

    <!-- Nivel 2 -->
    <div class="nivel">
      <h2>Nivel 2</h2>
      <div class="ramo" data-id="n2-alg2" onclick="toggleRamo(this)">√Ålgebra II (7)</div>
      <div class="ramo" data-id="n2-cal2" onclick="toggleRamo(this)">C√°lculo II (7)</div>
      <div class="ramo" data-id="n2-intprob2" onclick="toggleRamo(this)">Intro. a la Prob. y Estad. II (6)</div>
      <div class="ramo" data-id="n2-comp1" onclick="toggleRamo(this)">Computaci√≥n I (5)</div>
      <div class="ramo" data-id="n2-ing1" onclick="toggleRamo(this)">Ingl√©s I (3)</div>
      <div class="ramo" data-id="n2-expresion" onclick="toggleRamo(this)">T√©c. de Expresi√≥n Oral y Escrita (2)</div>
      <div class="creditos">30 cr√©ditos</div>
    </div>

    <!-- Nivel 3 -->
    <div class="nivel">
      <h2>Nivel 3</h2>
      <div class="ramo" data-id="n3-alglin" onclick="toggleRamo(this)">√Ålgebra Lineal (7)</div>
      <div class="ramo" data-id="n3-cal3" onclick="toggleRamo(this)">C√°lculo III (7)</div>
      <div class="ramo" data-id="n3-calprob" onclick="toggleRamo(this)">C√°lculo de Probabilidades (6)</div>
      <div class="ramo" data-id="n3-comp2" onclick="toggleRamo(this)">Computaci√≥n II (5)</div>
      <div class="ramo" data-id="n3-softest" onclick="toggleRamo(this)">Uso de Software Estad√≠stico (2)</div>
      <div class="ramo" data-id="n3-ing2" onclick="toggleRamo(this)">Ingl√©s II (3)</div>
      <div class="creditos">30 cr√©ditos</div>
    </div>

    <!-- Nivel 4 -->
    <div class="nivel">
      <h2>Nivel 4</h2>
      <div class="ramo" data-id="n4-compcal" onclick="toggleRamo(this)">Complementos de C√°lculo (7)</div>
      <div class="ramo" data-id="n4-inf" onclick="toggleRamo(this)">Inferencia Estad√≠stica (6)</div>
      <div class="ramo" data-id="n4-comp3" onclick="toggleRamo(this)">Computaci√≥n III (5)</div>
      <div class="ramo" data-id="n4-fis" onclick="toggleRamo(this)">F√≠sica General (4)</div>
      <div class="ramo" data-id="n4-inting" onclick="toggleRamo(this)">Intro. a Cs. de la Ingenier√≠a (5)</div>
      <div class="ramo" data-id="n4-ing3" onclick="toggleRamo(this)">Ingl√©s III (3)</div>
      <div class="creditos">30 cr√©ditos</div>
    </div>

    <!-- Nivel 5 -->
    <div class="nivel">
      <h2>Nivel 5</h2>
      <div class="ramo" data-id="n5-teoprob" onclick="toggleRamo(this)">Teor√≠a de Probabilidad (7)</div>
      <div class="ramo" data-id="n5-muestreo" onclick="toggleRamo(this)">Muestreo (6)</div>
      <div class="ramo" data-id="n5-modlin" onclick="toggleRamo(this)">Modelos Lineales (6)</div>
      <div class="ramo" data-id="n5-nopar" onclick="toggleRamo(this)">Estad√≠stica no Param√©trica (6)</div>
      <div class="ramo" data-id="n5-indlab" onclick="toggleRamo(this)">Inducci√≥n Laboral (2)</div>
      <div class="ramo" data-id="n5-ing4" onclick="toggleRamo(this)">Ingl√©s IV (3)</div>
      <div class="creditos">30 cr√©ditos</div>
    </div>

    <!-- Nivel 6 -->
    <div class="nivel">
      <h2>Nivel 6</h2>
      <div class="ramo" data-id="n6-procest" onclick="toggleRamo(this)">Procesos Estoc√°sticos (7)</div>
      <div class="ramo" data-id="n6-encuestas" onclick="toggleRamo(this)">Dise√±o y An√°lisis de Encuestas (6)</div>
      <div class="ramo" data-id="n6-multiv" onclick="toggleRamo(this)">M√©todos Multivariantes (7)</div>
      <div class="ramo" data-id="n6-simul" onclick="toggleRamo(this)">Simulaci√≥n Estad√≠stica (7)</div>
      <div class="ramo" data-id="n6-etica" onclick="toggleRamo(this)">√âtica Estad√≠stica (3)</div>
      <div class="creditos">30 cr√©ditos</div>
    </div>

    <!-- Nivel 7 -->
    <div class="nivel">
      <h2>Nivel 7</h2>
      <div class="ramo" data-id="n7-series" onclick="toggleRamo(this)">Series de Tiempo (7)</div>
      <div class="ramo" data-id="n7-exper" onclick="toggleRamo(this)">Dise√±o y An√°lisis de Experimentos (6)</div>
      <div class="ramo" data-id="n7-elect1" onclick="toggleRamo(this)">Electivo I (6)</div>
      <div class="ramo" data-id="n7-bio" onclick="toggleRamo(this)">Bioestad√≠stica (6)</div>
      <div class="ramo" data-id="n7-econ" onclick="toggleRamo(this)">Econom√≠a (5)</div>
      <div class="creditos">30 cr√©ditos</div>
    </div>

    <!-- Nivel 8 -->
    <div class="nivel">
      <h2>Nivel 8</h2>
      <div class="ramo" data-id="n8-taller1" onclick="toggleRamo(this)">Taller I (8)</div>
      <div class="ramo" data-id="n8-elect2" onclick="toggleRamo(this)">Electivo II (6)</div>
      <div class="ramo" data-id="n8-elect3" onclick="toggleRamo(this)">Electivo III (6)</div>
      <div class="ramo" data-id="n8-conta" onclick="toggleRamo(this)">Contabilidad y Costos (7)</div>
      <div class="ramo" data-id="n8-copro2" onclick="toggleRamo(this)">Coprogram√°tico II (3)</div>
      <div class="creditos">30 cr√©ditos</div>
    </div>

    <!-- Nivel 9 -->
    <div class="nivel">
      <h2>Nivel 9</h2>
      <div class="ramo" data-id="n9-taller2" onclick="toggleRamo(this)">Taller II (12)</div>
      <div class="ramo" data-id="n9-elect4" onclick="toggleRamo(this)">Electivo IV (6)</div>
      <div class="ramo" data-id="n9-semt1" onclick="toggleRamo(this)">Seminario de Tesis I (6)</div>
      <div class="ramo" data-id="n9-evalproj" onclick="toggleRamo(this)">Evaluaci√≥n de Proyectos (6)</div>
      <div class="creditos">30 cr√©ditos</div>
    </div>

    <!-- Nivel 10 -->
    <div class="nivel">
      <h2>Nivel 10</h2>
      <div class="ramo" data-id="n10-semt2" onclick="toggleRamo(this)">Seminario de Tesis II (26)</div>
      <div class="ramo" data-id="n10-comunic" onclick="toggleRamo(this)">Comunicaci√≥n Integral y Liderazgo (4)</div>
      <div class="creditos">30 cr√©ditos</div>
    </div>

  </div>
</body>
</html>
